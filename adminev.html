<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Event Management</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="CSS/admin.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <nav>
            <a href="AdminCO.html" class="nav-item">
                Content Management
            </a>
            <a href="AdminEv.html" class="nav-item active">
                Event Management
            </a>
            <a href="AdminUM.html" class="nav-item">
                User Management
            </a>
        </nav>
    </div>

    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <h2>Event Management</h2>
            <button class="btn" onclick="openModal('event-modal')">+ Create New Event</button>
        </div>

        <div class="search-section">
            <input type="text" class="search-bar" placeholder="Search events..." id="searchInput" oninput="searchEvents()">
        </div>

        <div class="filter-bar">
            <div class="filter-group">
                <select class="filter-select">
                    <option>Status</option>
                    <option>Upcoming</option>
                    <option>Ongoing</option>
                    <option>Completed</option>
                </select>
                <select class="filter-select">
                    <option>All Topics</option>
                    <option>Lung Cancer</option>
                    <option>Breast Cancer</option>
                    <option>Immunotherapy</option>
                </select>
            </div>
            <div class="sort-group">
                <select class="sort-select">
                    <option>Sort by: Date Saved</option>
                </select>
            </div>
        </div>

        <!-- Event Table Section -->
        <section id="event-management" class="section active">
            <table>
                <thead>
                    <tr>
                        <th>Event Poster</th>
                        <th>Event Title</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Venue</th>
                        <th>Topic</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><img src="" alt="Event Poster" class="event-poster"></td>
                        <td>Annual Oncology Conference 2024</td>
                        <td>March 15, 2024</td>
                        <td>9:00 AM - 5:00 PM</td>
                        <td>Grand Hotel Convention Center</td>
                        <td>Lung cancer</td>

                        <td><span class="status-badge status-upcoming">Upcoming</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-edit" onclick="openEditModal(this)">Edit</button>
                                <button class="btn-delete" onclick="deleteRow(this)">Delete</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><img src="" alt="Event Poster" class="event-poster"></td>
                        <td>Cancer Research Symposium</td>
                        <td>April 5, 2024</td>
                        <td>10:00 AM - 3:00 PM</td>
                        <td>Medical Research Center</td>
                        <td>Breast cancer</td>
                        <td><span class="status-badge status-upcoming">Upcoming</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-edit" onclick="openEditModal(this)">Edit</button>
                                <button class="btn-delete" onclick="deleteRow(this)">Delete</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
    </div>

     <!-- Event Creation Modal -->
    <div class="modal-overlay" id="event-modal">
        <div class="modal">
            <div class="modal-header">
                <h3>Create New Event</h3>
                <button class="close-btn" onclick="closeModal('event-modal')">&times;</button>
            </div>
            <form class="form-grid">
                <div class="form-group full-width">
                    <label for="event-title">Event Title</label>
                    <input type="text" id="event-title" required>
                </div>
                <div class="form-group">
                    <label for="event-date">Date</label>
                    <input type="date" id="event-date" required>
                </div>
                <div class="form-group">
                    <label for="event-time">Time</label>
                    <input type="time" id="event-time" required>
                </div>
                <div class="form-group full-width">
                    <label for="event-venue">Venue</label>
                    <input type="text" id="event-venue" required>
                </div>
                <div class="form-group">
                    <label for="event-status">Status</label>
                    <select id="event-status" required>
                        <option value="upcoming">Upcoming</option>
                        <option value="ongoing">Ongoing</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                <div class="form-group full-width">
                    <label for="event-description">Description</label>
                    <textarea id="event-description" rows="4" required></textarea>
                </div>
                <div class="form-group full-width">
                    <label for="event-poster">Event Poster</label>
                    <input type="file" id="event-poster" accept="image/*" required>
                </div>
                <button type="submit" class="btn full-width">Create Event</button>
            </form>
        </div>
    </div>

    <!-- Edit Event Modal -->
    <div class="modal-overlay" id="edit-modal">
        <div class="modal">
            <div class="modal-header">
                <h3>Edit Event</h3>
                <button class="close-btn" onclick="closeModal('edit-modal')">&times;</button>
            </div>
            <form class="form-grid">
                <div class="form-group full-width">
                    <label for="edit-title">Event Title</label>
                    <input type="text" id="edit-title" required>
                </div>
                <div class="form-group">
                    <label for="edit-date">Date</label>
                    <input type="date" id="edit-date" required>
                </div>
                <div class="form-group">
                    <label for="edit-time">Time</label>
                    <input type="time" id="edit-time" required>
                </div>
                <div class="form-group full-width">
                    <label for="edit-venue">Venue</label>
                    <input type="text" id="edit-venue" required>
                </div>
                <div class="form-group">
                    <label for="edit-status">Status</label>
                    <select id="edit-status" required>
                        <option value="upcoming">Upcoming</option>
                        <option value="ongoing">Ongoing</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                <div class="form-group full-width">
                    <label for="edit-description">Description</label>
                    <textarea id="edit-description" rows="4" required></textarea>
                </div>
                <div class="form-group full-width">
                    <label for="edit-poster">Update Poster</label>
                    <input type="file" id="edit-poster" accept="image/*">
                </div>
                <button type="submit" class="btn full-width">Save Changes</button>
            </form>
        </div>
    </div>

    <div class="pagination">
        <button class="page-btn active">1</button>
        <button class="page-btn">2</button>
        <button class="page-btn">3</button>
        <span>...</span>
        <button class="page-btn">8</button>
    </div>


    <script>
        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Delete row function
        function deleteRow(button) {
            if (confirm('Are you sure you want to delete this event?')) {
                button.closest('tr').remove();
            }
        }

        // Edit function
        function openEditModal(button) {
            const row = button.closest('tr');
            const title = row.cells[1].textContent;
            const date = row.cells[2].textContent;
            const time = row.cells[3].textContent;
            const venue = row.cells[4].textContent;
            const status = row.cells[5].querySelector('.status-badge').textContent;

            document.getElementById('edit-title').value = title;
            // Convert date to proper format for input
            const dateObj = new Date(date);
            document.getElementById('edit-date').value = dateObj.toISOString().split('T')[0];
            
            // Extract time from the time range
            const startTime = time.split(' - ')[0];
            document.getElementById('edit-time').value = convertTo24Hour(startTime);
            
            document.getElementById('edit-venue').value = venue;
            document.getElementById('edit-status').value = status.toLowerCase();
            document.getElementById('edit-topic').value = status.toLowerCase();

            openModal('edit-modal');
        }

        // Convert 12-hour time to 24-hour format
        function convertTo24Hour(time12h) {
            const [time, modifier] = time12h.split(' ');
            let [hours, minutes] = time.split(':');
            
            if (hours === '12') {
                hours = '00';
            }
            
            if (modifier === 'PM') {
                hours = parseInt(hours, 10) + 12;
            }
            
            return `${hours}:${minutes}`;
        }

        // Search function
        function searchEvents() {
            const input = document.getElementById('searchInput');
            const filter = input.value.toLowerCase();
            const tbody = document.querySelector('tbody');
            const rows = tbody.getElementsByTagName('tr');

            for (let row of rows) {
                const title = row.cells[1].textContent.toLowerCase();
                const venue = row.cells[4].textContent.toLowerCase();
                const date = row.cells[2].textContent.toLowerCase();
                
                row.style.display = 
                    title.includes(filter) || 
                    venue.includes(filter) || 
                    date.includes(filter)
                    ? '' 
                    : 'none';
            }
        }
    </script>
</body>
</html>